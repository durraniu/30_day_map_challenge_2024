{
  "hash": "f24a0013599eb7caf2225b75ca2b1555",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Day 7: Vintage style\"\ndate: \"2024-11-07\"\ncategories: [HDX]\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(sf) \nlibrary(grid)\nlibrary(showtext)\nfont_add_google(name = \"Yesteryear\", family = \"Yesteryear\")\nshowtext_auto()\n```\n:::\n\n\n\n# Creating vintage style\n\nI used `ggplot2::map_data` to get world map and `ggplot2::geom_map` for creating the map in this function:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncreate_vintage_map <- function(region = \"world\", \n                               bbox = NULL,\n                               paper_color = \"#F5E6CE\",\n                               water_color = \"#B9D3C2\",\n                               land_color = \"#DEB887\",\n                               border_color = \"#8B4513\",\n                               grid_color = \"#8B451366\") {\n  \n  # Get map data\n  world_map <- map_data(region)\n  \n  # Create base map\n  p <- ggplot() +\n    # Add water background\n    geom_rect(aes(xmin = -180, xmax = 180, ymin = -90, ymax = 90),\n              fill = water_color) +\n    # Add land\n    geom_map(data = world_map, map = world_map,\n             aes(map_id = region),\n             fill = land_color, color = border_color, linewidth = 0.2) +\n    # Add gridlines\n    geom_hline(yintercept = seq(-90, 90, by = 15), \n               color = grid_color, linewidth = 0.2, linetype = \"dashed\") +\n    geom_vline(xintercept = seq(-180, 180, by = 15),\n               color = grid_color, linewidth = 0.2, linetype = \"dashed\")\n  \n  # Add vintage styling\n  p <- p + theme(\n    panel.background = element_rect(fill = paper_color),\n    panel.grid = element_blank(),\n    axis.text = element_text(family = \"serif\", color = \"#8B4513\"),\n    axis.title = element_text(family = \"serif\", color = \"#8B4513\"),\n    plot.background = element_rect(fill = paper_color),\n    panel.border = element_rect(color = \"#8B4513\", fill = NA, linewidth = 1)\n  ) \n  \n  # Add aging effect\n  p <- p + annotate(\"rect\", xmin = -180, xmax = 180, ymin = -90, ymax = 90,\n                    fill = \"#8B4513\", alpha = 0.1)\n  \n  # If bbox is provided, zoom to that area\n  if (!is.null(bbox)) {\n    p <- p + coord_cartesian(xlim = c(bbox[1], bbox[2]),\n                             ylim = c(bbox[3], bbox[4]))\n  } else {\n    p <- p + coord_fixed(1.3)\n  }\n  \n  return(p)\n}\n```\n:::\n\n\n\n\n### Base map for Ontario\n\nUsing the bbox for Ontario:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nontario_bbox <- c(-95.16, -74.34, 41.66, 56.86) # xmin, xmax, ymin, ymax\nvintage_ontario <- create_vintage_map(region = \"world\", bbox = ontario_bbox)\nvintage_ontario\n```\n\n::: {.cell-output-display}\n![](day7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n## Data\n\nThen I added the health site locations on the map by using the data from [Humanitarian Data Exchange (HDX) website](https://data.humdata.org/dataset/canada-healthsites): \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncan_health <- sf::st_read(here::here(\"posts/day7/data/canada.geojson\"), \n                          quiet = TRUE) |> \n    dplyr::filter(st_geometry_type(geometry) == \"POINT\")\n\non_health <- can_health |>\n  st_crop(xmin = ontario_bbox[1], xmax = ontario_bbox[2], \n          ymin = ontario_bbox[3], ymax = ontario_bbox[4])\n```\n:::\n\n\n\n## Ontario Health Sites\n\nOntario health sites map with a custom font for the title:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvo_hs <- vintage_ontario +\n  geom_sf(data = on_health, aes(geometry = geometry), \n          color = \"#8B4513\",  \n          size = 2,           \n          alpha = 0.7) +      \n  coord_sf(xlim = c(ontario_bbox[1], ontario_bbox[2]),\n          ylim = c(ontario_bbox[3], ontario_bbox[4]))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nadd_vintage_title <- function(map, title, subtitle = NULL) {\n  map + \n    labs(title = title, subtitle = subtitle) +\n    theme(\n      plot.title = element_text(\n        family = \"Yesteryear\",\n        size = 25,\n        color = \"#8B4513\",\n        face = \"bold\",\n        hjust = 0.5\n      ),\n      plot.subtitle = element_text(\n        family = \"Yesteryear\",\n        size = 16,\n        color = \"#8B4513\",\n        hjust = 0.5\n      )\n    )\n}\n\nvo_hs |> add_vintage_title(title = \"Health Sites in Ontario\")\n```\n\n::: {.cell-output-display}\n![](day7_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "day7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}